define("ndi/touch/0.1.0/touch",["ndi/render/0.58.0/render"],function(a,b,c){function d(a){a.prototype.events.touch={LEFT_DOWN:"touchLeftDown",LEFT_UP:"touchLeftUp",LEFT_CLICK:"touchLeftClick",RIGHT:"rightTouch",OVER:"touchOver",MOVE:"touchMove",OUT:"touchOut"},a.createAction("touch",function(a,b,c){var d=this,f=[],g=this.events.touch,h=this.values=this.values||{},i=a.models.map(function(a){var b=d.getHash(a);return f.push(b),b.render}),j=this.enableMouse().mouseManager,k=this.__projector__=new e.Projector,l=this.__raycaster__=new e.Raycaster;return j.on(j.MOVE,function(a){var b=d.__render__.camera,c=new e.Vector3(2*(a.offsetX/d.width)-1,2*-(a.offsetY/d.height)+1,-1);k.unprojectVector(c,b),l.set(b.position,c.sub(b.position).normalize());var j=l.intersectObjects(i);if(j.length>0){var m=d.__event3D__=j[0],n=m.object;i.forEach(function(b,c){var d=h[b.id]=h[b.id]||{},e=f[c];b!==n||d.isOver||(d.isOver=!0,e.trigger(g.OVER,m,a)),b===n&&e.trigger(g.MOVE,m,a),b!==n&&d.isOver&&(d.isOver=!1,e.trigger(g.OUT,m,a))})}else i.forEach(function(b,c){var e=h[b.id]=h[b.id]||{},i=f[c];e.isOver&&(e.isOver=!1,i.trigger(g.OUT,d.__event3D__,a))})}),j.on(j.LEFT_DOWN,function(a){i.forEach(function(b,c){var e=h[b.id]=h[b.id]||{},i=f[c];e.isOver&&(e.isDown=!0,i.trigger(g.LEFT_DOWN,d.__event3D__,a))})}),j.on(j.LEFT_UP,function(a){i.forEach(function(b,c){var e=h[b.id]=h[b.id]||{},i=f[c];i.trigger(g.LEFT_UP,d.__event3D__,a),e.isOver&&(e.isDown&&i.trigger(g.LEFT_CLICK,d.__event3D__,a),e.isDown=!1)})}),c&&c(),this})}var e=a("ndi/render/0.58.0/render");c.exports=d});
