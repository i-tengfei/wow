define("ndi/render-extend/0.1.0/render-extend",["ndi/render/0.58.0/render"],function(a){var b=a("ndi/render/0.58.0/render");b.Color.prototype.val=function(){return this.getHex()},b.Vector2.prototype.val=function(a,c){return"number"==typeof a&&"number"==typeof c?(this.x=a,this.y=c,this):Array.isArray(a)&&2===a.length&&void 0===c?this.val(a[0],a[1]):a instanceof b.Vector2&&void 0===c?this.val(a.x,a.y):void 0===a?[this.x,this.y]:void 0},b.Vector3.prototype.val=function(a,c,d){return"number"==typeof a&&"number"==typeof c&&"number"==typeof d?(this.x=a,this.y=c,this.z=d,this):Array.isArray(a)&&3===a.length&&void 0===c?this.val(a[0],a[1],a[2]):a instanceof b.Vector3&&void 0===c?this.val(a.x,a.y,a.z):void 0===a?[this.x,this.y,this.z]:void 0},b.Vector3.prototype.mul=function(a,c,d){return"number"==typeof a&&"number"==typeof c&&"number"==typeof d?(this.x*=a,this.y*=c,this.z*=d,this):a instanceof b.Vector3&&c instanceof b.Vector3&&void 0===d?this.val(a).mul(c):a instanceof b.Vector3&&void 0===c?this.mul(a.x,a.y,a.z):"number"==typeof a&&void 0===c?this.mul(a,a,a):void 0},b.Loader.prototype.createMaterial=function(a,c){function d(a){var b=Math.log(a)/Math.LN2;return Math.floor(b)==b}function e(a){var b=Math.log(a)/Math.LN2;return Math.pow(2,Math.round(b))}function f(a,b){var f=new Image;f.onload=function(){if(d(this.width)&&d(this.height))a.image=this;else{var b=e(this.width),c=e(this.height);a.image.width=b,a.image.height=c,a.image.getContext("2d").drawImage(this,0,0,b,c)}a.needsUpdate=!0},f.crossOrigin=i.crossOrigin,"__delay__"!==c&&(f.src=b)}function g(a,d,e,g,h,i,j){var k=/\.dds$/i.test(e),l=c+"/"+e;if(k){var m=b.ImageUtils.loadCompressedTexture(l);a[d]=m}else{var m=document.createElement("canvas");a[d]=new b.Texture(m)}if(a[d].sourceFile=e,g&&(a[d].repeat.set(g[0],g[1]),1!==g[0]&&(a[d].wrapS=b.RepeatWrapping),1!==g[1]&&(a[d].wrapT=b.RepeatWrapping)),h&&a[d].offset.set(h[0],h[1]),i){var n={repeat:b.RepeatWrapping,mirror:b.MirroredRepeatWrapping};void 0!==n[i[0]]&&(a[d].wrapS=n[i[0]]),void 0!==n[i[1]]&&(a[d].wrapT=n[i[1]])}j&&(a[d].anisotropy=j),k||f(a[d],l)}function h(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]}var i=this,j="MeshLambertMaterial",k={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(a.shading){var l=a.shading.toLowerCase();"phong"===l?j="MeshPhongMaterial":"basic"===l&&(j="MeshBasicMaterial")}if(void 0!==a.blending&&void 0!==b[a.blending]&&(k.blending=b[a.blending]),(void 0!==a.transparent||a.opacity<1)&&(k.transparent=a.transparent),void 0!==a.depthTest&&(k.depthTest=a.depthTest),void 0!==a.depthWrite&&(k.depthWrite=a.depthWrite),void 0!==a.visible&&(k.visible=a.visible),void 0!==a.flipSided&&(k.side=b.BackSide),void 0!==a.doubleSided&&(k.side=b.DoubleSide),void 0!==a.wireframe&&(k.wireframe=a.wireframe),void 0!==a.vertexColors&&("face"===a.vertexColors?k.vertexColors=b.FaceColors:a.vertexColors&&(k.vertexColors=b.VertexColors)),a.colorDiffuse?k.color=h(a.colorDiffuse):a.DbgColor&&(k.color=a.DbgColor),a.colorSpecular&&(k.specular=h(a.colorSpecular)),a.colorAmbient&&(k.ambient=h(a.colorAmbient)),a.transparency&&(k.opacity=a.transparency),a.specularCoef&&(k.shininess=a.specularCoef),a.mapDiffuse&&c&&g(k,"map",a.mapDiffuse,a.mapDiffuseRepeat,a.mapDiffuseOffset,a.mapDiffuseWrap,a.mapDiffuseAnisotropy),a.mapLight&&c&&g(k,"lightMap",a.mapLight,a.mapLightRepeat,a.mapLightOffset,a.mapLightWrap,a.mapLightAnisotropy),a.mapBump&&c&&g(k,"bumpMap",a.mapBump,a.mapBumpRepeat,a.mapBumpOffset,a.mapBumpWrap,a.mapBumpAnisotropy),a.mapNormal&&c&&g(k,"normalMap",a.mapNormal,a.mapNormalRepeat,a.mapNormalOffset,a.mapNormalWrap,a.mapNormalAnisotropy),a.mapSpecular&&c&&g(k,"specularMap",a.mapSpecular,a.mapSpecularRepeat,a.mapSpecularOffset,a.mapSpecularWrap,a.mapSpecularAnisotropy),a.mapBumpScale&&(k.bumpScale=a.mapBumpScale),a.mapNormal){var m=b.ShaderLib.normalmap,n=b.UniformsUtils.clone(m.uniforms);n.tNormal.value=k.normalMap,a.mapNormalFactor&&n.uNormalScale.value.set(a.mapNormalFactor,a.mapNormalFactor),k.map&&(n.tDiffuse.value=k.map,n.enableDiffuse.value=!0),k.specularMap&&(n.tSpecular.value=k.specularMap,n.enableSpecular.value=!0),k.lightMap&&(n.tAO.value=k.lightMap,n.enableAO.value=!0),n.uDiffuseColor.value.setHex(k.color),n.uSpecularColor.value.setHex(k.specular),n.uAmbientColor.value.setHex(k.ambient),n.uShininess.value=k.shininess,void 0!==k.opacity&&(n.uOpacity.value=k.opacity);var o={fragmentShader:m.fragmentShader,vertexShader:m.vertexShader,uniforms:n,lights:!0,fog:!0},p=new b.ShaderMaterial(o);k.transparent&&(p.transparent=!0)}else var p=new b[j](k);return void 0!==a.DbgName&&(p.name=a.DbgName),p},b.JSONLoader.prototype.parse=function(a,c){function d(c){function d(a,b){return a&1<<b}var e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=a.faces,H=a.vertices,I=a.normals,J=a.colors,K=0;if(void 0!==a.uvs){for(e=0;e<a.uvs.length;e++)a.uvs[e].length&&K++;for(e=0;K>e;e++)g.faceUvs[e]=[],g.faceVertexUvs[e]=[]}for(i=0,j=H.length;j>i;)y=new b.Vector3,y.x=H[i++]*c,y.y=H[i++]*c,y.z=H[i++]*c,g.vertices.push(y);for(i=0,j=G.length;j>i;){if(p=G[i++],q=d(p,0),r=d(p,1),s=d(p,2),t=d(p,3),u=d(p,4),v=d(p,5),w=d(p,6),x=d(p,7),q?(z=new b.Face4,z.a=G[i++],z.b=G[i++],z.c=G[i++],z.d=G[i++],k=4):(z=new b.Face3,z.a=G[i++],z.b=G[i++],z.c=G[i++],k=3),r&&(o=G[i++],z.materialIndex=o),h=g.faces.length,s)for(e=0;K>e;e++)C=a.uvs[e],n=G[i++],E=C[2*n],F=C[2*n+1],g.faceUvs[e][h]=new b.Vector2(E,F);if(t)for(e=0;K>e;e++){for(C=a.uvs[e],D=[],f=0;k>f;f++)n=G[i++],E=C[2*n],F=C[2*n+1],D[f]=new b.Vector2(E,F);g.faceVertexUvs[e][h]=D}if(u&&(m=3*G[i++],B=new b.Vector3,B.x=I[m++],B.y=I[m++],B.z=I[m],z.normal=B),v)for(e=0;k>e;e++)m=3*G[i++],B=new b.Vector3,B.x=I[m++],B.y=I[m++],B.z=I[m],z.vertexNormals.push(B);if(w&&(l=G[i++],A=new b.Color(J[l]),z.color=A),x)for(e=0;k>e;e++)l=G[i++],A=new b.Color(J[l]),z.vertexColors.push(A);g.faces.push(z)}}function e(){var c,d,e,f,h,i,j,k,l,m;if(a.skinWeights)for(c=0,d=a.skinWeights.length;d>c;c+=4)e=a.skinWeights[c],f=a.skinWeights[c+1],h=a.skinWeights[c+2],i=a.skinWeights[c+3],g.skinWeights.push(new b.Vector4(e,f,h,i));if(a.skinIndices)for(c=0,d=a.skinIndices.length;d>c;c+=4)j=a.skinIndices[c],k=a.skinIndices[c+1],l=a.skinIndices[c+2],m=a.skinIndices[c+3],g.skinIndices.push(new b.Vector4(j,k,l,m));g.bones=a.bones,g.animation=a.animation}function f(c){if(void 0!==a.morphTargets){var d,e,f,h,i,j;for(d=0,e=a.morphTargets.length;e>d;d++)for(g.morphTargets[d]={},g.morphTargets[d].name=a.morphTargets[d].name,g.morphTargets[d].vertices=[],i=g.morphTargets[d].vertices,j=a.morphTargets[d].vertices,f=0,h=j.length;h>f;f+=3){var k=new b.Vector3;k.x=j[f]*c,k.y=j[f+1]*c,k.z=j[f+2]*c,i.push(k)}}if(void 0!==a.morphColors){var d,e,l,m,n,o,p;for(d=0,e=a.morphColors.length;e>d;d++)for(g.morphColors[d]={},g.morphColors[d].name=a.morphColors[d].name,g.morphColors[d].colors=[],n=g.morphColors[d].colors,o=a.morphColors[d].colors,l=0,m=o.length;m>l;l+=3)p=new b.Color(16755200),p.setRGB(o[l],o[l+1],o[l+2]),n.push(p)}}var g=new b.Geometry,h=void 0!==a.scale?1/a.scale:1;if(d(h),e(),f(h),g.computeCentroids(),g.computeFaceNormals(),g.computeBoundingSphere(),void 0===a.materials)return{geometry:g};var i=this.initMaterials(a.materials,c);return this.needsTangents(i)&&g.computeTangents(),{geometry:g,materials:i}}});
